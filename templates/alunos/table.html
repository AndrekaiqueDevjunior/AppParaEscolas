<!-- <div class='row sticky_element bg-white pt-2 pb-2 mt-2 mb-2'>
	<div class='col'>
		<h1>
			
		</h1>
	</div>
</div> -->
<div class="sticky_element pt-1 bg-white">
	<div class='row mt-2'>
		<div class='col'>
			<input
				type="text"
				class="form-control"
				placeholder="Pesquisar"
				oninput="pesquisar_multiuso(this, 'tbody_aluno')"
			/>
		</div>
	</div>	

	<div class='row mt-2 pb-1 border-bottom'>
		<div class='col text-center'>
			<label style="font-size: large; font-weight: 600; text-align: center;">Tabela dos Alunos</label>
		</div>
	</div>
</div>	


<div class='row mt-2'>
	<div class='col'>
		<table class='table'>
			<thead class=''>
				<tr>
					<th style='text-align: center; font-size: 1px; padding: 0px; margin: 0px;'>&nbsp;</th>
				</tr>
			</thead>
			<tbody id='tbody_aluno'></tbody>
		</table>
	</div>
</div>

<script>
	function pesquisar_multiuso(elemento, id_do_tbody){
		var valor_procurado = (elemento.value).toLowerCase()
		document
			.getElementById(id_do_tbody)
			.querySelectorAll('tr')
			.forEach((linha) => {
				var valor_de_todas_as_celulas = ''
				linha
					.querySelectorAll('td')
					.forEach((celula) => {
						valor_de_todas_as_celulas += (celula.innerHTML).toLowerCase()
					})
				if(
					valor_de_todas_as_celulas.includes(valor_procurado)
				){
					linha.style.display = 'table-row'
				} else {
					linha.style.display = 'none'
				}
			})
	}
	function alterar_aluno(id_clicado){
		$.ajax({
			url: '/ler_aluno_especifico',
			type: 'POST',
			data: JSON.stringify({id: id_clicado}),
			contentType: "application/json",
			dataType: "json",
		}).done(function (data){
			navegar_table_para_form_aluno()			
			capta_e_direciona_dados(data)
			})
	}
	function capta_e_direciona_dados(data){
		var dados_para_escrever = data.dados[0]
		var cabecalho = data.cabecalho
		var input_aluno = document.querySelectorAll('.input_aluno')
			
		// Loop em todo o cabecalho
		cabecalho.forEach((item, index) => {
			// passar por todos os elementos
			// com a classe: input_aluno
			input_aluno.forEach((item_2, index_2) => {
				// Perguntar 1 por 1
				// Se o nome do elemento é igual
				// Ao nome do cabecalho
				if(item_2.name == item[1]){	
					// Determina o valor do elemento
					// De acordo com o que voltou do Flask
					item_2.value = dados_para_escrever[index]
				}
			})
		})
		
	}
	
	function gera_table_aluno(){
		// LEITURA DOS DADOS
		$.ajax({
			url: '/ler_todos_alunos',
			type: 'POST'			
		}).done(function (retorno){
			$('#tbody_aluno').html('')
			
			var dados = retorno.dados
			dados.forEach((item) => {
				// LINHA QUE APARECE PARA O USUÁRIO
				var tr = document.createElement('tr')
				
				tr.onclick = () => {
					alterar_aluno(item[0])
				}
				
				var td = document.createElement('td')
				var string_celula = "Nome:" + item[1]
				string_celula += "<br>"
				string_celula += "Sobrenome:" + item[2]
				string_celula += "<br>"
				string_celula += "CPF:" + item[7]
				string_celula += "<br>"
				string_celula += `
					<div class='text-end'>
						<button class="btn btn-outline-primary" style='border-radius: 0px;'>
							<i class="bi bi-pencil-square"></i>
						</button>
					</div>
					`
				
				td.innerHTML = string_celula
				
				td.classList.add('border')

				tr.appendChild(td)
				$('#tbody_aluno').append(tr)

				// LINHA PARA SEPARAR UMA LINHA DA OUTRA
				var tr = document.createElement('tr')
				var td = document.createElement('td')
				td.innerHTML = '&nbsp;'
				td.style.fontSize = '1px'
				tr.appendChild(td)
				
				$('#tbody_aluno').append(tr)
				
			})
		})
	}
	
	$( document ).ready(function() {
		gera_table_aluno()
	});
</script>